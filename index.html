<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sunflower Head Sprouting</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #4a7c2f;
            background-image: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 1px,
                    rgba(255, 255, 255, 0.03) 1px,
                    rgba(255, 255, 255, 0.03) 2px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 1px,
                    rgba(0, 0, 0, 0.05) 1px,
                    rgba(0, 0, 0, 0.05) 2px
                ),
                linear-gradient(
                    180deg,
                    #5a8c3f 0%,
                    #4a7c2f 50%,
                    #3a6c1f 100%
                );
            overflow: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(ellipse at 20% 30%, rgba(90, 140, 63, 0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(58, 108, 31, 0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(74, 124, 47, 0.2) 0%, transparent 50%);
            pointer-events: none;
        }

        body::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    transparent 3px,
                    rgba(0, 0, 0, 0.02) 3px,
                    rgba(0, 0, 0, 0.02) 6px
                );
            pointer-events: none;
        }

        .sunflower-field {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
        }

        .sunflower {
            position: absolute;
        }

        .sunflower.animate {
            animation: bloom 3s ease forwards;
        }

        @keyframes bloom {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(360deg);
                opacity: 1;
            }
        }

        /* Center */
        .center {
            width: 120px;
            height: 120px;
            background: #654321;
            border-radius: 50%;
            position: relative;
            z-index: 3;
        }

        .center::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle, #543210 3px, transparent 3px);
            background-size: 15px 15px;
            background-position: 4px 4px;
            border-radius: 50%;
        }

        /* Petals container */
        .petals {
            position: absolute;
            width: 300px;
            height: 300px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
        }

        .petal {
            position: absolute;
            width: 50px;
            height: 75px;
            background: #FFFF00;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            top: 50%;
            left: 50%;
            transform-origin: center center;
            opacity: 0;
        }

        .petal.show {
            animation: petal-grow 0.5s ease forwards;
        }

        @keyframes petal-grow {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        /* Front petals (inner layer) */
        .front-petals {
            position: absolute;
            width: 280px;
            height: 280px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
        }

        .front-petal {
            position: absolute;
            width: 45px;
            height: 68px;
            background: #E6D700;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            top: 50%;
            left: 50%;
            transform-origin: center center;
            opacity: 0;
        }

        .front-petal.show {
            animation: petal-grow 0.5s ease forwards;
        }

        /* Buttons */
        .btn {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 40px;
            font-size: 20px;
            font-weight: bold;
            background: #FFFF00;
            border: 3px solid #654321;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, opacity 0.3s;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
        }

        .btn.show {
            opacity: 1;
            pointer-events: all;
        }

        .btn:hover {
            transform: translateX(-50%) scale(1.05);
        }

        .btn:active {
            transform: translateX(-50%) scale(0.95);
        }

        #moreBtn {
            bottom: 120px;
        }
    </style>
</head>
<body>
    <div class="sunflower-field" id="sunflowerField"></div>

    <button class="btn" id="moreBtn">click for more</button>
    <button class="btn" id="resetBtn">isa pa nga</button>

    <script>
        const sunflowerField = document.getElementById('sunflowerField');
        const moreBtn = document.getElementById('moreBtn');
        const resetBtn = document.getElementById('resetBtn');
        
        let clickCount = 0;
        let occupiedSpaces = [];

        function createSunflowerElement(x, y, scale = 1, delay = 0) {
            const sunflower = document.createElement('div');
            sunflower.className = 'sunflower';
            sunflower.style.left = x + '%';
            sunflower.style.top = y + '%';
            sunflower.style.transform = `translate(-50%, -50%) scale(${scale})`;
            
            const petalsContainer = document.createElement('div');
            petalsContainer.className = 'petals';
            
            const frontPetalsContainer = document.createElement('div');
            frontPetalsContainer.className = 'front-petals';
            
            const center = document.createElement('div');
            center.className = 'center';
            
            sunflower.appendChild(petalsContainer);
            sunflower.appendChild(frontPetalsContainer);
            sunflower.appendChild(center);
            
            sunflowerField.appendChild(sunflower);
            
            // Store occupied space
            occupiedSpaces.push({ x, y, scale });
            
            // Trigger bloom animation
            setTimeout(() => {
                sunflower.classList.add('animate');
            }, delay);
            
            // Create back petals
            for (let i = 0; i < 13; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                const angle = (i * (360 / 13)) - 90;
                petal.style.transform = `translate(-50%, -50%) rotate(${angle}deg) translateY(-110px)`;
                petalsContainer.appendChild(petal);
                
                setTimeout(() => {
                    petal.classList.add('show');
                }, delay + 1000 + (i * 80));
            }
            
            // Create front petals
            const backPetalsDelay = delay + 1000 + (13 * 80);
            for (let i = 0; i < 13; i++) {
                const frontPetal = document.createElement('div');
                frontPetal.className = 'front-petal';
                const angle = (i * (360 / 13)) - 90 + (360 / 26);
                frontPetal.style.transform = `translate(-50%, -50%) rotate(${angle}deg) translateY(-102px)`;
                frontPetalsContainer.appendChild(frontPetal);
                
                setTimeout(() => {
                    frontPetal.classList.add('show');
                }, backPetalsDelay + 200 + (i * 80));
            }
            
            return sunflower;
        }

        function checkOverlap(x, y, scale) {
            // Calculate minimum distance based on scale (sunflower size)
            const baseRadius = 15; // Base radius in percentage units
            
            for (let space of occupiedSpaces) {
                const distance = Math.sqrt(Math.pow(x - space.x, 2) + Math.pow(y - space.y, 2));
                const minDistance = baseRadius * (scale + space.scale);
                
                if (distance < minDistance) {
                    return true; // Overlap detected
                }
            }
            return false; // No overlap
        }

        function getRandomPosition(scale) {
            let attempts = 0;
            let x, y;
            
            while (attempts < 100) {
                x = Math.random() * 80 + 10; // 10% to 90%
                y = Math.random() * 80 + 10; // 10% to 90%
                
                if (!checkOverlap(x, y, scale)) {
                    return { x, y };
                }
                attempts++;
            }
            
            // If we can't find a spot after 100 attempts, just return a random position
            return { x: Math.random() * 80 + 10, y: Math.random() * 80 + 10 };
        }

        function getRandomScale() {
            return Math.random() * 0.5 + 0.5; // 0.5 to 1.0
        }

        function addSunflowers(count) {
            for (let i = 0; i < count; i++) {
                const scale = getRandomScale();
                const pos = getRandomPosition(scale);
                createSunflowerElement(pos.x, pos.y, scale, i * 300);
            }
        }

        function fillScreen() {
            // Try to fill remaining spaces
            let filled = 0;
            let attempts = 0;
            
            while (filled < 30 && attempts < 200) {
                const scale = Math.random() * 0.4 + 0.3; // 0.3 to 0.7 (smaller for filling gaps)
                const x = Math.random() * 90 + 5;
                const y = Math.random() * 90 + 5;
                
                if (!checkOverlap(x, y, scale)) {
                    createSunflowerElement(x, y, scale, filled * 80);
                    filled++;
                }
                attempts++;
            }
        }

        function initFirstSunflower() {
            // Create the first sunflower exactly in the center
            createSunflowerElement(50, 50, 1, 0);
            
            // Show "click for more" button after first sunflower blooms
            setTimeout(() => {
                moreBtn.classList.add('show');
            }, 1000 + (13 * 80) + 200 + (13 * 80) + 500); // After all animations
        }

        moreBtn.addEventListener('click', () => {
            clickCount++;
            
            if (clickCount === 1) {
                addSunflowers(1);
            } else if (clickCount === 2) {
                addSunflowers(2);
            } else if (clickCount === 3) {
                addSunflowers(4);
            } else if (clickCount === 4) {
                addSunflowers(5);
            } else if (clickCount === 5) {
                addSunflowers(9);
            } else if (clickCount === 6) {
                moreBtn.classList.remove('show');
                fillScreen();
                
                // Show reset button after filling screen
                setTimeout(() => {
                    resetBtn.classList.add('show');
                }, 3000);
            }
        });

        resetBtn.addEventListener('click', () => {
            // Clear all sunflowers
            sunflowerField.innerHTML = '';
            clickCount = 0;
            occupiedSpaces = [];
            
            // Hide buttons
            moreBtn.classList.remove('show');
            resetBtn.classList.remove('show');
            
            // Start over
            initFirstSunflower();
        });

        // Initialize
        initFirstSunflower();
    </script>
</body>
</html>
